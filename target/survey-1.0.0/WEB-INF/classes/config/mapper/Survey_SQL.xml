<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="survey">

	<select id="selectBoardList" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			select ID, JNAME
			from connect_test
		]]>
	</select>

	<select id="selectSurveyMaster" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			SELECT SURVEY_ANS_MST_SN, SURVEY_SN, ORG_CD, OPER_CD, SURVEY_CD, SURVEY_NM, HSPTL_ID, REGEXP_REPLACE(SUFRER_PIN, '.', '*', 8) AS SUFRER_PIN, REGEXP_REPLACE(SUFRER_NM, '.', '*', 3) AS SUFRER_NM, SEXDSTN, BRTHDY, SUFRER_RELATE, SURVEY_DE, RM, USE_AT, REG_DT, REGUSR, UPD_DT, UPDUSR, ANS_NM
			FROM SURVEY.SURVEY_ANS_MST
			where SURVEY_ANS_MST_SN=#{surveyAnsMstSn} and ORG_CD=#{orgCd}
		]]>
	</select>

	<select id="selectSurveyResult" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
			
	select 
		MAX(Q1) AS "Q1",
		MAX(Q1_2) AS "Q1_2",
		MAX(Q1_4T) AS "Q1_4T",
		MAX(Q1_3) AS "Q1_3",
		MAX(Q2_0_1) AS "Q2_0_1",
		MAX(Q2_0_2) AS "Q2_0_2",
		MAX(Q2_0_3) AS "Q2_0_3",
		MAX(Q2_1_1) AS "Q2_1_1",
		MAX(Q2_1_2) AS "Q2_1_2",
		MAX(Q2_1_3) AS "Q2_1_3",
		MAX(Q2_2_1) AS "Q2_2_1",
		MAX(Q2_2_2) AS "Q2_2_2",
		MAX(Q2_2_3) AS "Q2_2_3",
		MAX(Q2_3_1) AS "Q2_3_1",
		MAX(Q2_3_2) AS "Q2_3_2",
		MAX(Q2_3_3) AS "Q2_3_3",
		MAX(Q2_4_1) AS "Q2_4_1",
		MAX(Q2_4_2) AS "Q2_4_2",
		MAX(Q2_4_3) AS "Q2_4_3",
		MAX(Q2_5_1) AS "Q2_5_1",
		MAX(Q2_5_2) AS "Q2_5_2",
		MAX(Q2_5_3) AS "Q2_5_3",
		MAX(Q2_6_1) AS "Q2_6_1",
		MAX(Q2_6_2) AS "Q2_6_2",
		MAX(Q2_6_3) AS "Q2_6_3",
		MAX(Q3) AS "Q3",
		MAX(Q4) AS "Q4",
		MAX(Q5_0) AS "Q5_0",
		MAX(Q5_1_0) AS "Q5_1_0",
		MAX(Q5_1_1) AS "Q5_1_1",
		MAX(Q5_1_2) AS "Q5_1_2",
		MAX(Q5_2_0) AS "Q5_2_0",
		MAX(Q5_2_1) AS "Q5_2_1",
		MAX(Q6_1_0) AS "Q6_1_0",
		MAX(Q6_1_1) AS "Q6_1_1",
		MAX(Q6_1_2) AS "Q6_1_2",
		MAX(Q6_1_3) AS "Q6_1_3",
		MAX(Q6_2_0) AS "Q6_2_0",
		MAX(Q6_2_1) AS "Q6_2_1",
		MAX(Q6_2_2) AS "Q6_2_2",
		MAX(Q6_2_3) AS "Q6_2_3",
		MAX(Q6_3_0) AS "Q6_3_0",
		MAX(Q6_3_1) AS "Q6_3_1",
		MAX(Q6_3_2) AS "Q6_3_2",
		MAX(Q6_3_3) AS "Q6_3_3",
		MAX(Q6_4_0) AS "Q6_4_0",
		MAX(Q6_4_1) AS "Q6_4_1",
		MAX(Q6_4_2) AS "Q6_4_2",
		MAX(Q6_4_3) AS "Q6_4_3",
		MAX(Q6_5_0) AS "Q6_5_0",
		MAX(Q6_5_1) AS "Q6_5_1",
		MAX(Q6_5_2) AS "Q6_5_2",
		MAX(Q6_5_3) AS "Q6_5_3",
		MAX(Q6_6_0) AS "Q6_6_0",
		MAX(Q6_6_1) AS "Q6_6_1",
		MAX(Q6_6_2) AS "Q6_6_2",
		MAX(Q6_6_3) AS "Q6_6_3",
		MAX(Q6_7_0) AS "Q6_7_0",
		MAX(Q6_7_1) AS "Q6_7_1",
		MAX(Q6_7_2) AS "Q6_7_2",
		MAX(Q6_7_3) AS "Q6_7_3",
		MAX(Q6_8_0) AS "Q6_8_0",
		MAX(Q6_8_1) AS "Q6_8_1",
		MAX(Q6_8_2) AS "Q6_8_2",
		MAX(Q6_8_3) AS "Q6_8_3",
		MAX(Q6_9_0) AS "Q6_9_0",
		MAX(Q6_9_1) AS "Q6_9_1",
		MAX(Q6_9_2) AS "Q6_9_2",
		MAX(Q6_9_3) AS "Q6_9_3",
		MAX(Q6_10_0) AS "Q6_10_0",
		MAX(Q6_10_1) AS "Q6_10_1",
		MAX(Q6_10_2) AS "Q6_10_2",
		MAX(Q6_10_3) AS "Q6_10_3",
		MAX(Q6_11_0) AS "Q6_11_0",
		MAX(Q6_11_1) AS "Q6_11_1",
		MAX(Q6_11_2) AS "Q6_11_2",
		MAX(Q6_11_3) AS "Q6_11_3",
		MAX(Q6_12_0) AS "Q6_12_0",
		MAX(Q6_12_1) AS "Q6_12_1",
		MAX(Q6_12_2) AS "Q6_12_2",
		MAX(Q6_12_3) AS "Q6_12_3",
		MAX(Q6_13_0) AS "Q6_13_0",
		MAX(Q6_13_1) AS "Q6_13_1",
		MAX(Q7_1) AS "Q7_1",
		MAX(Q7_2) AS "Q7_2",
		MAX(Q8_0_0) AS "Q8_0_0",
		MAX(Q8_1_0) AS "Q8_1_0",
		MAX(Q8_2_0) AS "Q8_2_0",
		MAX(Q9) AS "Q9",
		MAX(Q9_1_0) AS "Q9_1_0",
		MAX(Q9_1_1) AS "Q9_1_1",
		MAX(Q9_1_2) AS "Q9_1_2",
		MAX(Q9_1_3) AS "Q9_1_3",
		MAX(Q10_0_0) AS "Q10_0_0",
		MAX(Q10_1_1_1) AS "Q10_1_1_1",
		MAX(Q10_1_1_2) AS "Q10_1_1_2",
		MAX(Q10_1_2_1) AS "Q10_1_2_1",
		MAX(Q10_1_2_2) AS "Q10_1_2_2",
		MAX(Q10_1_3_1) AS "Q10_1_3_1",
		MAX(Q10_1_3_2) AS "Q10_1_3_2",
		MAX(Q10_1_4_1) AS "Q10_1_4_1",
		MAX(Q10_1_4_2) AS "Q10_1_4_2",
		MAX(Q10_1_5_1) AS "Q10_1_5_1",
		MAX(Q10_1_5_2) AS "Q10_1_5_2",
		MAX(Q10_1_6_1) AS "Q10_1_6_1",
		MAX(Q10_1_6_2) AS "Q10_1_6_2",
		MAX(Q10_1_6_3) AS "Q10_1_6_3",
		MAX(Q10_1_6_4) AS "Q10_1_6_4",
		MAX(Q10_1_6_5) AS "Q10_1_6_5",
		MAX(Q11_0_0) AS "Q11_0_0",
		MAX(Q11_1_1) AS "Q11_1_1",
		MAX(Q11_1_2) AS "Q11_1_2",
		MAX(Q11_2_1_1) AS "Q11_2_1_1",
		MAX(Q11_2_1_2) AS "Q11_2_1_2",
		MAX(Q11_2_2_1) AS "Q11_2_2_1",
		MAX(Q11_2_2_2) AS "Q11_2_2_2",
		MAX(Q11_2_3_1) AS "Q11_2_3_1",
		MAX(Q11_2_3_2) AS "Q11_2_3_2",
		MAX(Q11_2_4_1) AS "Q11_2_4_1",
		MAX(Q11_2_4_2) AS "Q11_2_4_2",
		MAX(Q11_2_5_1) AS "Q11_2_5_1",
		MAX(Q11_2_5_2) AS "Q11_2_5_2",
		MAX(Q11_2_6_1) AS "Q11_2_6_1",
		MAX(Q11_2_6_2) AS "Q11_2_6_2",
		MAX(Q11_2_6_3) AS "Q11_2_6_3",
		MAX(Q11_2_6_4) AS "Q11_2_6_4",
		MAX(Q11_2_6_5) AS "Q11_2_6_5",
		MAX(Q12) AS "Q12"
	from (
		select
				decode(qn_cd, 'Q1', ans_value, '') as "Q1",
				decode(qn_cd, 'Q1_2', ans_value, '') as "Q1_2",
				decode(qn_cd, 'Q1_4T', ans_value, '') as "Q1_4T",
				decode(qn_cd, 'Q1_3', ans_value, '') as "Q1_3",
				decode(qn_cd, 'Q2_0_1', ans_value, '') as "Q2_0_1",
				decode(qn_cd, 'Q2_0_2', ans_value, '') as "Q2_0_2",
				decode(qn_cd, 'Q2_0_3', ans_value, '') as "Q2_0_3",
				decode(qn_cd, 'Q2_1_1', ans_value, '') as "Q2_1_1",
				decode(qn_cd, 'Q2_1_2', ans_value, '') as "Q2_1_2",
				decode(qn_cd, 'Q2_1_3', ans_value, '') as "Q2_1_3",
				decode(qn_cd, 'Q2_2_1', ans_value, '') as "Q2_2_1",
				decode(qn_cd, 'Q2_2_2', ans_value, '') as "Q2_2_2",
				decode(qn_cd, 'Q2_2_3', ans_value, '') as "Q2_2_3",
				decode(qn_cd, 'Q2_3_1', ans_value, '') as "Q2_3_1",
				decode(qn_cd, 'Q2_3_2', ans_value, '') as "Q2_3_2",
				decode(qn_cd, 'Q2_3_3', ans_value, '') as "Q2_3_3",
				decode(qn_cd, 'Q2_4_1', ans_value, '') as "Q2_4_1",
				decode(qn_cd, 'Q2_4_2', ans_value, '') as "Q2_4_2",
				decode(qn_cd, 'Q2_4_3', ans_value, '') as "Q2_4_3",
				decode(qn_cd, 'Q2_5_1', ans_value, '') as "Q2_5_1",
				decode(qn_cd, 'Q2_5_2', ans_value, '') as "Q2_5_2",
				decode(qn_cd, 'Q2_5_3', ans_value, '') as "Q2_5_3",
				decode(qn_cd, 'Q2_6_1', ans_value, '') as "Q2_6_1",
				decode(qn_cd, 'Q2_6_2', ans_value, '') as "Q2_6_2",
				decode(qn_cd, 'Q2_6_3', ans_value, '') as "Q2_6_3",
				decode(qn_cd, 'Q3', ans_value, '') as "Q3",
				decode(qn_cd, 'Q4', ans_value, '') as "Q4",
				decode(qn_cd, 'Q5_0', ans_value, '') as "Q5_0",
				decode(qn_cd, 'Q5_1_0', ans_value, '') as "Q5_1_0",
				decode(qn_cd, 'Q5_1_1', ans_value, '') as "Q5_1_1",
				decode(qn_cd, 'Q5_1_2', ans_value, '') as "Q5_1_2",
				decode(qn_cd, 'Q5_2_0', ans_value, '') as "Q5_2_0",
				decode(qn_cd, 'Q5_2_1', ans_value, '') as "Q5_2_1",
				decode(qn_cd, 'Q6_1_0', ans_value, '') as "Q6_1_0",
				decode(qn_cd, 'Q6_1_1', ans_value, '') as "Q6_1_1",
				decode(qn_cd, 'Q6_1_2', ans_value, '') as "Q6_1_2",
				decode(qn_cd, 'Q6_1_3', ans_value, '') as "Q6_1_3",
				decode(qn_cd, 'Q6_2_0', ans_value, '') as "Q6_2_0",
				decode(qn_cd, 'Q6_2_1', ans_value, '') as "Q6_2_1",
				decode(qn_cd, 'Q6_2_2', ans_value, '') as "Q6_2_2",
				decode(qn_cd, 'Q6_2_3', ans_value, '') as "Q6_2_3",
				decode(qn_cd, 'Q6_3_0', ans_value, '') as "Q6_3_0",
				decode(qn_cd, 'Q6_3_1', ans_value, '') as "Q6_3_1",
				decode(qn_cd, 'Q6_3_2', ans_value, '') as "Q6_3_2",
				decode(qn_cd, 'Q6_3_3', ans_value, '') as "Q6_3_3",
				decode(qn_cd, 'Q6_4_0', ans_value, '') as "Q6_4_0",
				decode(qn_cd, 'Q6_4_1', ans_value, '') as "Q6_4_1",
				decode(qn_cd, 'Q6_4_2', ans_value, '') as "Q6_4_2",
				decode(qn_cd, 'Q6_4_3', ans_value, '') as "Q6_4_3",
				decode(qn_cd, 'Q6_5_0', ans_value, '') as "Q6_5_0",
				decode(qn_cd, 'Q6_5_1', ans_value, '') as "Q6_5_1",
				decode(qn_cd, 'Q6_5_2', ans_value, '') as "Q6_5_2",
				decode(qn_cd, 'Q6_5_3', ans_value, '') as "Q6_5_3",
				decode(qn_cd, 'Q6_6_0', ans_value, '') as "Q6_6_0",
				decode(qn_cd, 'Q6_6_1', ans_value, '') as "Q6_6_1",
				decode(qn_cd, 'Q6_6_2', ans_value, '') as "Q6_6_2",
				decode(qn_cd, 'Q6_6_3', ans_value, '') as "Q6_6_3",
				decode(qn_cd, 'Q6_7_0', ans_value, '') as "Q6_7_0",
				decode(qn_cd, 'Q6_7_1', ans_value, '') as "Q6_7_1",
				decode(qn_cd, 'Q6_7_2', ans_value, '') as "Q6_7_2",
				decode(qn_cd, 'Q6_7_3', ans_value, '') as "Q6_7_3",
				decode(qn_cd, 'Q6_8_0', ans_value, '') as "Q6_8_0",
				decode(qn_cd, 'Q6_8_1', ans_value, '') as "Q6_8_1",
				decode(qn_cd, 'Q6_8_2', ans_value, '') as "Q6_8_2",
				decode(qn_cd, 'Q6_8_3', ans_value, '') as "Q6_8_3",
				decode(qn_cd, 'Q6_9_0', ans_value, '') as "Q6_9_0",
				decode(qn_cd, 'Q6_9_1', ans_value, '') as "Q6_9_1",
				decode(qn_cd, 'Q6_9_2', ans_value, '') as "Q6_9_2",
				decode(qn_cd, 'Q6_9_3', ans_value, '') as "Q6_9_3",
				decode(qn_cd, 'Q6_10_0', ans_value, '') as "Q6_10_0",
				decode(qn_cd, 'Q6_10_1', ans_value, '') as "Q6_10_1",
				decode(qn_cd, 'Q6_10_2', ans_value, '') as "Q6_10_2",
				decode(qn_cd, 'Q6_10_3', ans_value, '') as "Q6_10_3",
				decode(qn_cd, 'Q6_11_0', ans_value, '') as "Q6_11_0",
				decode(qn_cd, 'Q6_11_1', ans_value, '') as "Q6_11_1",
				decode(qn_cd, 'Q6_11_2', ans_value, '') as "Q6_11_2",
				decode(qn_cd, 'Q6_11_3', ans_value, '') as "Q6_11_3",
				decode(qn_cd, 'Q6_12_0', ans_value, '') as "Q6_12_0",
				decode(qn_cd, 'Q6_12_1', ans_value, '') as "Q6_12_1",
				decode(qn_cd, 'Q6_12_2', ans_value, '') as "Q6_12_2",
				decode(qn_cd, 'Q6_12_3', ans_value, '') as "Q6_12_3",
				decode(qn_cd, 'Q6_13_0', ans_value, '') as "Q6_13_0",
				decode(qn_cd, 'Q6_13_1', ans_value, '') as "Q6_13_1",
				decode(qn_cd, 'Q7_1', ans_value, '') as "Q7_1",
				decode(qn_cd, 'Q7_2', ans_value, '') as "Q7_2",
				decode(qn_cd, 'Q8_0_0', ans_value, '') as "Q8_0_0",
				decode(qn_cd, 'Q8_1_0', ans_value, '') as "Q8_1_0",
				decode(qn_cd, 'Q8_2_0', ans_value, '') as "Q8_2_0",
				decode(qn_cd, 'Q9', ans_value, '') as "Q9",
				decode(qn_cd, 'Q9_1_0', ans_value, '') as "Q9_1_0",
				decode(qn_cd, 'Q9_1_1', ans_value, '') as "Q9_1_1",
				decode(qn_cd, 'Q9_1_2', ans_value, '') as "Q9_1_2",
				decode(qn_cd, 'Q9_1_3', ans_value, '') as "Q9_1_3",
				decode(qn_cd, 'Q10_0_0', ans_value, '') as "Q10_0_0",
				decode(qn_cd, 'Q10_1_1_1', ans_value, '') as "Q10_1_1_1",
				decode(qn_cd, 'Q10_1_1_2', ans_value, '') as "Q10_1_1_2",
				decode(qn_cd, 'Q10_1_2_1', ans_value, '') as "Q10_1_2_1",
				decode(qn_cd, 'Q10_1_2_2', ans_value, '') as "Q10_1_2_2",
				decode(qn_cd, 'Q10_1_3_1', ans_value, '') as "Q10_1_3_1",
				decode(qn_cd, 'Q10_1_3_2', ans_value, '') as "Q10_1_3_2",
				decode(qn_cd, 'Q10_1_4_1', ans_value, '') as "Q10_1_4_1",
				decode(qn_cd, 'Q10_1_4_2', ans_value, '') as "Q10_1_4_2",
				decode(qn_cd, 'Q10_1_5_1', ans_value, '') as "Q10_1_5_1",
				decode(qn_cd, 'Q10_1_5_2', ans_value, '') as "Q10_1_5_2",
				decode(qn_cd, 'Q10_1_6_1', ans_value, '') as "Q10_1_6_1",
				decode(qn_cd, 'Q10_1_6_2', ans_value, '') as "Q10_1_6_2",
				decode(qn_cd, 'Q10_1_6_3', ans_value, '') as "Q10_1_6_3",
				decode(qn_cd, 'Q10_1_6_4', ans_value, '') as "Q10_1_6_4",
				decode(qn_cd, 'Q10_1_6_5', ans_value, '') as "Q10_1_6_5",
				decode(qn_cd, 'Q11_0_0', ans_value, '') as "Q11_0_0",
				decode(qn_cd, 'Q11_1_1', ans_value, '') as "Q11_1_1",
				decode(qn_cd, 'Q11_1_2', ans_value, '') as "Q11_1_2",
				decode(qn_cd, 'Q11_2_1_1', ans_value, '') as "Q11_2_1_1",
				decode(qn_cd, 'Q11_2_1_2', ans_value, '') as "Q11_2_1_2",
				decode(qn_cd, 'Q11_2_2_1', ans_value, '') as "Q11_2_2_1",
				decode(qn_cd, 'Q11_2_2_2', ans_value, '') as "Q11_2_2_2",
				decode(qn_cd, 'Q11_2_3_1', ans_value, '') as "Q11_2_3_1",
				decode(qn_cd, 'Q11_2_3_2', ans_value, '') as "Q11_2_3_2",
				decode(qn_cd, 'Q11_2_4_1', ans_value, '') as "Q11_2_4_1",
				decode(qn_cd, 'Q11_2_4_2', ans_value, '') as "Q11_2_4_2",
				decode(qn_cd, 'Q11_2_5_1', ans_value, '') as "Q11_2_5_1",
				decode(qn_cd, 'Q11_2_5_2', ans_value, '') as "Q11_2_5_2",
				decode(qn_cd, 'Q11_2_6_1', ans_value, '') as "Q11_2_6_1",
				decode(qn_cd, 'Q11_2_6_2', ans_value, '') as "Q11_2_6_2",
				decode(qn_cd, 'Q11_2_6_3', ans_value, '') as "Q11_2_6_3",
				decode(qn_cd, 'Q11_2_6_4', ans_value, '') as "Q11_2_6_4",
				decode(qn_cd, 'Q11_2_6_5', ans_value, '') as "Q11_2_6_5",
				decode(qn_cd, 'Q12', ans_value, '') as "Q12"
			from(
				SELECT qn_cd, ans_value
 				FROM SURVEY.SURVEY_ANS
 				where SURVEY_ANS_MST_SN=#{surveyAnsMstSn} and ORG_CD=#{orgCd}
			)
		)
		]]>
	</select>

</mapper>